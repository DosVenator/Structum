<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Structum</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192.png">
<link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-192.png">
  <link rel="manifest" href="/manifest.json" />
<meta name="theme-color" content="#0f1220" />
</head>
<body>

  <!-- TOAST / –°–æ–æ–±—â–µ–Ω–∏—è -->
  <div id="toast" class="toast hidden"></div>

  <!-- LOGIN -->
  <div id="loginBox" class="center-screen">
    <div class="card auth-card">
      <h2 class="title">üîë –í—Ö–æ–¥</h2>
      <input id="loginInput" placeholder="–õ–æ–≥–∏–Ω" autocomplete="username" />
      <input id="passInput" type="password" placeholder="–ü–∞—Ä–æ–ª—å" autocomplete="current-password" />
      <button id="loginBtn" class="btn btn-primary w100">–í–æ–π—Ç–∏</button>
      <div id="loginError" class="error"></div>
    </div>
  </div>

  <!-- MAIN APP -->
  <div id="appBox" class="hidden">
    <header class="topbar">
      <div class="topbar-left">
        <div class="brand">üì¶ –£—á—ë—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</div>
        <div class="subtitle">
          <span id="currentObject"></span>
        </div>
      </div>

      <div class="topbar-right">
        <span id="userChip" class="chip">üë§ ‚Äî</span>

        <button id="transferBtn" class="btn btn-primary">
          üîÑ –ü–µ—Ä–µ–¥–∞—á–∏ <span id="transferBadge" class="badge hidden"></span>
        </button>

        <button id="logoutBtn" class="btn btn-secondary">üö™ –í—ã–π—Ç–∏</button>
      </div>
    </header>

    <main class="container">
      <!-- USER CONTROLS (—Å–∫—Ä–æ—é—Ç—Å—è –¥–ª—è admin) -->
      <section id="userControls" class="controls card">
        <input id="search" placeholder="üîç –ü–æ–∏—Å–∫..." />
        <button id="startScan" class="btn btn-primary">üì∑ –ö–∞–º–µ—Ä–∞</button>
        <button id="stopScan" class="btn btn-secondary">‚èπ –ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
        <button id="manualAdd" class="btn btn-primary">‚ûï –î–æ–¥–∞—Ç–∏ –≤—Ä—É—á–Ω—É</button>
      </section>

      <!-- CAMERA -->
      <section id="cameraBox" class="card hidden">
        <div id="reader"></div>
        <p id="status" class="muted"></p>
      </section>

      <!-- ADMIN PANEL (–≤–∏–¥–Ω–æ —Ç–æ–ª—å–∫–æ admin) -->
      <section id="adminPanel" class="card hidden">
        <h3 class="section-title">üßë‚Äçüíº –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h3>
        <div class="admin-tools">
  <label class="muted">–û–±—ä–µ–∫—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞:</label>
  <select id="adminObjectSelect"></select>
  <button id="adminReportBtn" class="btn btn-primary">üìä –û—Ç—á—ë—Ç</button>
</div>
        <div class="admin-grid">
          <div class="admin-block">
            <div class="admin-block-head">
              <h4>–û–±—ä–µ–∫—Ç—ã (—Å–∫–ª–∞–¥—ã)</h4>
              <button id="openAddObject" class="btn btn-primary">‚ûï –û–±—ä–µ–∫—Ç</button>
            </div>
            <ul id="objectsList" class="simple-list"></ul>
          </div>

          <div class="admin-block">
            <div class="admin-block-head">
              <h4>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h4>
              <button id="openAddUser" class="btn btn-primary">‚ûï –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</button>
            </div>
            <ul id="usersList" class="simple-list"></ul>
          </div>
        </div>
      </section>

      <!-- LIST -->
      <section class="card">
        <h3 class="section-title">üìã –°–ø–∏—Å–æ–∫</h3>
        <ul id="list"></ul>
      </section>
    </main>
  </div>

  <!-- MODAL: –ü—Ä–∏—Ö–æ–¥ (—Ä—É—á–Ω–æ–π/–ø–æ—Å–ª–µ —Å–∫–∞–Ω–∞) -->
  <div id="intakeModal" class="modal hidden">
    <div class="modal-content">
      <h3>‚ûï –ü—Ä–∏—Ö–æ–¥</h3>

      <label>–®—Ç—Ä–∏—Ö–∫–æ–¥</label>
      <input id="mCode" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 520229..." />
      <div class="hint">–ú–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å —Ü–∏—Ñ—Ä—ã. –ü—Ä–æ–±–µ–ª—ã –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.</div>

      <label>–ù–∞–∑–≤–∞–Ω–∏–µ</label>
      <input id="mName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–µ—Ä—á–∞—Ç–∫–∏" />

      <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</label>
      <input id="mQty" type="number" inputmode="numeric" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 2" />

      <label>–û—Ç –∫–æ–≥–æ</label>
      <input id="mFrom" placeholder="–ü–æ—Å—Ç–∞–≤—â–∏–∫ / –º–∞–≥–∞–∑–∏–Ω" />

      <div id="mError" class="error"></div>

      <div class="modal-actions">
        <button id="mSave" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button id="mCancel" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <!-- MODAL: –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–ø—Ä–æ—Å–∏—Ç—å "–ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ?" -->
  <div id="continueModal" class="modal hidden">
    <div class="modal-content">
      <h3>‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ</h3>
      <p class="muted">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ?</p>
      <div class="modal-actions">
        <button id="contYes" class="btn btn-primary">üì∑ –î–∞</button>
        <button id="contNo" class="btn btn-secondary">–ù–µ—Ç</button>
      </div>
    </div>
  </div>

  <!-- MODAL: –ò—Å—Ç–æ—Ä–∏—è -->
  <div id="historyModal" class="modal hidden">
    <div class="modal-content">
      <h3 id="hTitle">üìú –ò—Å—Ç–æ—Ä–∏—è</h3>
      <div id="hBody" class="history-body"></div>
      <div class="modal-actions">
        <button id="hClose" class="btn btn-secondary">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- MODAL: –°–ø–∏—Å–∞–Ω–∏–µ -->
  <div id="writeoffModal" class="modal hidden">
    <div class="modal-content">
      <h3>‚ûñ –°–ø–∏—Å–∞–Ω–∏–µ</h3>
      <p id="wTitle" class="muted"></p>

      <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</label>
      <input id="wQty" type="number" inputmode="numeric" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 1" />

      <label>–ö–æ–º—É / –∫—É–¥–∞</label>
      <input id="wTo" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ë—Ä–∏–≥–∞–¥–∞ 2 / —É—á–∞—Å—Ç–æ–∫" />

      <div id="wError" class="error"></div>

      <div class="modal-actions">
        <button id="wSave" class="btn btn-primary">–°–ø–∏—Å–∞—Ç—å</button>
        <button id="wCancel" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <!-- TRANSFER MODAL -->
  <div id="transferModal" class="modal hidden">
    <div class="modal-content">
      <h3>üì§ –ü–µ—Ä–µ–¥–∞—Ç—å —Ç–æ–≤–∞—Ä</h3>
      <p id="transferItemName" class="muted"></p>

      <label>–ö—É–¥–∞</label>
      <select id="transferTo"></select>

      <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</label>
      <input id="transferQty" type="number" inputmode="numeric" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ" />

      <div id="transferError" class="error"></div>

      <div class="modal-actions">
        <button id="confirmTransfer" class="btn btn-primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        <button id="cancelTransfer" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <!-- INCOMING TRANSFERS MODAL -->
  <div id="incomingModal" class="modal hidden">
    <div class="modal-content">
      <h3>üì• –í—Ö–æ–¥—è—â–∏–µ –ø–µ—Ä–µ–¥–∞—á–∏</h3>
      <ul id="incomingList" class="simple-list"></ul>
      <div class="modal-actions">
        <button id="incomingClose" class="btn btn-secondary">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- MODAL: –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è -->
  <div id="pwdModal" class="modal hidden">
    <div class="modal-content">
      <h3>üîí –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è</h3>
      <p class="muted">–≠—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —à–∞–≥ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ.</p>

      <label id="pOldLabel">–°—Ç–∞—Ä—ã–π –ø–∞—Ä–æ–ª—å</label>
<input id="pOld" type="password" placeholder="–°—Ç–∞—Ä—ã–π –ø–∞—Ä–æ–ª—å" autocomplete="current-password" />

      <label>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
      <input id="p1" type="password" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å" />

      <label>–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
      <input id="p2" type="password" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" />

      <div id="pError" class="error"></div>

      <div class="modal-actions">
        <button id="pSave" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- ADMIN: –¥–æ–±–∞–≤–∏—Ç—å –æ–±—ä–µ–∫—Ç -->
  <div id="addObjectModal" class="modal hidden">
    <div class="modal-content">
      <h3>‚ûï –ù–æ–≤—ã–π –æ–±—ä–µ–∫—Ç</h3>
      <label>–ù–∞–∑–≤–∞–Ω–∏–µ</label>
      <input id="objName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –°–∫–ª–∞–¥ 3" />
      <div id="objError" class="error"></div>
      <div class="modal-actions">
        <button id="objSave" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
        <button id="objCancel" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <!-- ADMIN: –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
  <div id="addUserModal" class="modal hidden">
    <div class="modal-content">
      <h3>‚ûï –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h3>

      <label>–õ–æ–≥–∏–Ω</label>
      <input id="uLogin" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: sklad3" />

      <label>–û–±—ä–µ–∫—Ç</label>
      <select id="uObject"></select>

      <label>–í—Ä–µ–º–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å</label>
      <input id="uPass" placeholder="–°–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å" />

      <div id="uError" class="error"></div>

      <div class="modal-actions">
        <button id="uSave" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
        <button id="uCancel" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
      </div>

      <p class="muted" style="margin-top:10px">
        –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—É–¥–µ—Ç –æ–±—è–∑–∞–Ω —Å–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å.
      </p>
    </div>
  </div>
<!-- MODAL: Confirm -->
<div id="confirmModal" class="modal hidden">
  <div class="modal-content">
    <h3 id="cTitle">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</h3>
    <p id="cText" class="muted"></p>

    <div class="modal-actions">
      <button id="cYes" class="btn btn-danger">–£–¥–∞–ª–∏—Ç—å</button>
      <button id="cNo" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
    </div>
  </div>
</div>
<!-- ADMIN: REPORT MODAL -->
<div id="reportModal" class="modal hidden">
  <div class="modal-content modal-wide">
    <div class="modal-head">
      <h3>üìä –û—Ç—á—ë—Ç</h3>
      <button id="rClose" class="btn btn-secondary">‚úï</button>
    </div>

    <div class="report-form">
      <div class="field">
        <label>–û–±—ä–µ–∫—Ç</label>
        <select id="rObject"></select>
      </div>

      <div class="field">
        <label>–° –¥–∞—Ç—ã</label>
        <input id="rFrom" type="date" />
      </div>

      <div class="field">
        <label>–ü–æ –¥–∞—Ç—É</label>
        <input id="rTo" type="date" />
      </div>

      <div class="field">
        <label>–†–µ–∂–∏–º</label>
        <div class="radio-row">
          <label><input id="rModeAll" type="radio" name="rMode" checked /> –ü–æ –≤—Å–µ–º —Ç–æ–≤–∞—Ä–∞–º</label>
          <label><input id="rModeOne" type="radio" name="rMode" /> –ü–æ –æ–¥–Ω–æ–º—É —Ç–æ–≤–∞—Ä—É</label>
        </div>
      </div>

      <div class="field">
  <label>–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–π</label>
  <select id="rType">
    <option value="all">–í—Å–µ</option>
    <option value="in">–¢–æ–ª—å–∫–æ –ø—Ä–∏—Ö–æ–¥</option>
    <option value="out">–¢–æ–ª—å–∫–æ —Ä–∞—Å—Ö–æ–¥</option>
  </select>
</div>

      <div class="field hidden" id="rItemWrap">
        <label>–¢–æ–≤–∞—Ä</label>
        <select id="rItem"></select>
      </div>

      <div class="field">
        <button id="rBuild" class="btn btn-primary w100">–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å</button>
        <div id="rError" class="error"></div>
      </div>
    </div>

    <div id="rTableWrap" class="report-output"></div>
  </div>
</div>
<div id="appSplash" class="app-splash">
  <div class="app-splash__bg"></div>

  <div class="app-splash__content">
    <div class="app-splash__logo"></div>

    <div class="app-splash__title">
      –£—á—ë—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
    </div>

    <div class="app-splash__subtitle" id="splashText">
      –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è‚Ä¶
    </div>

    <div class="app-splash__progress">
      <div class="app-splash__bar" id="splashBar"></div>
    </div>
  </div>
</div>
  <script src="https://unpkg.com/html5-qrcode"></script>
  <script src="/js/store.js"></script>
  <script src="/js/scanner.js"></script>
  <script src="/js/app.js"></script>
</body>
</html>